import pandas as pd
CBR_bonds = pd.read_excel("CBR_bonds.xlsx")
print(CBR_bonds)
	Дата	0.25	0.5	0.75	1	2	3	5	7	10	15	20	30
0	2015-12-30	9.05	9.67	10.01	10.17	10.14	9.97	9.78	9.69	9.56	9.47	9.43	9.40
1	2015-12-29	9.37	9.95	10.21	10.30	10.15	9.99	9.82	9.71	9.57	9.46	9.43	9.41
2	2015-12-28	9.47	10.03	10.30	10.40	10.27	10.06	9.84	9.71	9.58	9.47	9.44	9.41
3	2015-12-25	9.55	10.13	10.40	10.50	10.33	10.10	9.87	9.75	9.62	9.54	9.51	9.48
4	2015-12-24	9.69	10.27	10.53	10.60	10.39	10.17	9.95	9.80	9.61	9.49	9.47	9.46
5	2015-12-23	9.71	10.29	10.56	10.66	10.49	10.27	10.03	9.88	9.69	9.56	9.52	9.51
6	2015-12-22	9.88	10.45	10.69	10.76	10.52	10.28	10.06	9.93	9.76	9.62	9.58	9.55
7	2015-12-21	9.79	10.36	10.62	10.71	10.51	10.27	10.02	9.86	9.66	9.52	9.48	9.46
8	2015-12-18	9.79	10.37	10.63	10.70	10.49	10.27	10.03	9.85	9.63	9.49	9.46	9.46
9	2015-12-17	9.73	10.33	10.61	10.71	10.54	10.31	10.03	9.84	9.63	9.50	9.48	9.48
10	2015-12-16	9.51	10.11	10.43	10.57	10.52	10.33	10.08	9.89	9.63	9.48	9.46	9.47
11	2015-12-15	9.94	10.57	10.79	10.82	10.54	10.33	10.10	9.92	9.70	9.60	9.61	9.66
12	2015-12-14	9.94	10.57	10.74	10.74	10.51	10.39	10.20	10.05	9.97	9.95	9.96	9.97
13	2015-12-11	9.79	10.44	10.63	10.65	10.46	10.32	10.09	9.94	9.86	9.85	9.87	9.89
14	2015-12-10	9.60	10.26	10.47	10.50	10.33	10.22	10.04	9.91	9.84	9.82	9.82	9.83
15	2015-12-09	9.49	10.18	10.42	10.48	10.36	10.24	10.04	9.91	9.83	9.82	9.83	9.84
16	2015-12-08	9.32	10.04	10.35	10.46	10.43	10.33	10.14	10.00	9.91	9.87	9.87	9.87
17	2015-12-07	9.16	9.89	10.24	10.40	10.43	10.34	10.16	10.02	9.92	9.86	9.84	9.82
18	2015-12-04	9.00	9.73	10.12	10.30	10.36	10.22	9.98	9.82	9.72	9.69	9.70	9.70
19	2015-12-03	8.99	9.73	10.11	10.30	10.38	10.26	10.02	9.87	9.79	9.75	9.75	9.75
20	2015-12-02	9.01	9.77	10.14	10.31	10.34	10.18	9.92	9.77	9.71	9.70	9.71	9.72
21	2015-12-01	9.31	10.05	10.32	10.40	10.29	10.14	9.92	9.78	9.70	9.70	9.72	9.73
22	2015-11-30	8.93	9.69	10.08	10.26	10.35	10.23	10.00	9.85	9.77	9.73	9.73	9.73
23	2015-11-27	9.35	10.11	10.41	10.51	10.41	10.26	10.02	9.88	9.79	9.78	9.79	9.80
24	2015-11-26	9.02	9.78	10.12	10.26	10.29	10.20	10.00	9.85	9.77	9.74	9.73	9.73
25	2015-11-25	9.55	10.26	10.48	10.51	10.31	10.22	10.08	9.95	9.86	9.83	9.84	9.84
26	2015-11-24	9.37	10.12	10.39	10.45	10.31	10.22	10.07	9.95	9.87	9.84	9.83	9.82
27	2015-11-23	8.80	9.58	9.98	10.17	10.22	10.08	9.87	9.75	9.69	9.65	9.64	9.62
28	2015-11-20	9.01	9.81	10.14	10.26	10.16	10.00	9.73	9.57	9.51	9.50	9.50	9.50
29	2015-11-19	8.82	9.63	10.01	10.17	10.14	9.95	9.68	9.54	9.51	9.52	9.52	9.53
...	...	...	...	...	...	...	...	...	...	...	...	...	...
2794	2005-02-21	3.62	4.11	4.56	4.96	6.20	6.97	7.76	8.09	8.29	8.39	8.42	8.42
2795	2005-02-18	3.75	4.23	4.67	5.06	6.25	7.00	7.78	8.11	8.31	8.41	8.44	8.44
2796	2005-02-17	3.67	4.14	4.58	4.97	6.18	6.96	7.78	8.14	8.35	8.44	8.46	8.44
2797	2005-02-16	3.67	4.15	4.60	5.00	6.22	7.00	7.82	8.16	8.35	8.44	8.46	8.44
2798	2005-02-15	3.58	4.06	4.51	4.91	6.16	6.96	7.78	8.10	8.27	8.34	8.36	8.37
2799	2005-02-14	3.67	4.15	4.58	4.97	6.18	6.97	7.78	8.11	8.28	8.35	8.38	8.39
2800	2005-02-11	3.64	4.11	4.54	4.93	6.13	6.90	7.69	8.02	8.21	8.30	8.33	8.36
2801	2005-02-10	3.67	4.15	4.58	4.98	6.19	6.98	7.78	8.09	8.26	8.33	8.35	8.37
2802	2005-02-09	3.72	4.19	4.62	5.01	6.21	6.97	7.75	8.06	8.23	8.32	8.35	8.37
2803	2005-02-08	3.78	4.23	4.64	5.01	6.17	6.94	7.75	8.08	8.26	8.34	8.37	8.39
2804	2005-02-07	3.60	4.04	4.44	4.81	5.99	6.78	7.61	7.96	8.15	8.25	8.29	8.33
2805	2005-02-04	3.73	4.18	4.58	4.95	6.10	6.86	7.66	7.99	8.18	8.28	8.32	8.36
2806	2005-02-03	3.84	4.27	4.67	5.02	6.14	6.89	7.71	8.06	8.26	8.36	8.40	8.43
2807	2005-02-02	3.67	4.09	4.48	4.84	6.01	6.81	7.68	8.06	8.28	8.38	8.41	8.43
2808	2005-02-01	3.89	4.30	4.67	5.02	6.12	6.89	7.74	8.10	8.32	8.42	8.46	8.48
2809	2005-01-31	3.88	4.28	4.65	4.99	6.08	6.86	7.73	8.12	8.34	8.45	8.48	8.49
2810	2005-01-28	3.78	4.18	4.55	4.88	5.97	6.76	7.65	8.06	8.30	8.43	8.46	8.47
2811	2005-01-27	4.13	4.54	4.91	5.24	6.28	7.00	7.80	8.15	8.38	8.50	8.55	8.56
2812	2005-01-26	4.08	4.51	4.89	5.23	6.30	7.02	7.81	8.16	8.39	8.52	8.57	8.58
2813	2005-01-25	4.12	4.55	4.93	5.27	6.34	7.07	7.87	8.22	8.44	8.56	8.59	8.59
2814	2005-01-24	4.01	4.40	4.75	5.06	6.09	6.83	7.68	8.08	8.36	8.53	8.59	8.58
2815	2005-01-21	4.09	4.51	4.88	5.22	6.30	7.03	7.82	8.18	8.43	8.59	8.64	8.62
2816	2005-01-20	4.00	4.40	4.75	5.08	6.11	6.83	7.66	8.05	8.32	8.49	8.55	8.54
2817	2005-01-19	4.10	4.49	4.83	5.15	6.14	6.84	7.65	8.03	8.29	8.45	8.50	8.51
2818	2005-01-18	4.16	4.54	4.88	5.18	6.15	6.85	7.67	8.04	8.29	8.44	8.50	8.50
2819	2005-01-17	4.13	4.53	4.88	5.19	6.18	6.89	7.71	8.09	8.33	8.48	8.52	8.51
2820	2005-01-14	4.07	4.47	4.82	5.13	6.12	6.82	7.62	7.99	8.23	8.36	8.41	8.43
2821	2005-01-13	4.07	4.47	4.83	5.14	6.12	6.82	7.62	7.99	8.23	8.37	8.41	8.42
2822	2005-01-12	3.63	4.05	4.44	4.78	5.88	6.64	7.51	7.93	8.18	8.32	8.35	8.34
2823	2005-01-11	3.82	4.27	4.69	5.05	6.18	6.94	7.78	8.15	8.36	8.46	8.48	8.45
2824 rows × 13 columns

import pyodbc 
server = 'DESKTOP-1N69II6\MS Access' 
database = 'Ruslan_BD' 
username = 'user0' 
password = 'ruskhram' 
cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password)

OurISIN=input() # ввести ISIN интересующей Вас облигаций и нажать ENTER

SqlQuery1= ("""
SELECT [TIME],[Y2O_ASK], [Y2O_BID], [YIELD_ASK],[YIELD_BID] 
FROM [Ruslan_BD].[dbo].[bond_yields] 
WHERE ([ISIN] = 'RU000A0JQ4F1') 
AND ((([Y2O_ASK] != 0) AND ([Y2O_BID] != 0)) 
OR (([YIELD_ASK] != 0) AND ([YIELD_BID] != 0)));
""")

bond_yield = pd.read_sql(SqlQuery1, cnxn)

from datetime import datetime

t = datetime(1900, 1, 1).toordinal() + pd.to_numeric(bond_yield['TIME'].dropna()).astype(int) - 2 
for i in range(0, len(t)):
    t.iloc[i] = datetime.fromordinal(t.iloc[i])
    
bond_yield['date'] = t
